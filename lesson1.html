<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>الدرس الأول - مقدمة في البرمجة بلغة JavaScript</title>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #f9f9f9, #e0f7fa);
      color: #222;
      text-align: center;
      padding: 20px;
    }

    h1 {
      color: #00796b;
      font-size: 2em;
    }

    .content {
      max-width: 850px;
      margin: auto;
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      text-align: right;
    }

    .code-editor {
      width: 100%;
      height: 150px;
      font-family: "Courier New", monospace;
      font-size: 15px;
      direction: ltr;
      text-align: left;
      border: 2px solid #009688;
      border-radius: 10px;
      padding: 10px;
      background-color: #f1f8e9;
      color: #000;
      transition: 0.3s;
    }

    .code-editor:focus {
      background-color: #e0f2f1;
      box-shadow: 0 0 10px #26a69a;
    }

    .btn {
      background: linear-gradient(90deg, #009688, #26a69a);
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      margin-top: 10px;
      transition: all 0.3s ease;
    }

    .btn:hover {
      transform: scale(1.05);
      background: linear-gradient(90deg, #00796b, #004d40);
    }

    .output {
      margin-top: 10px;
      background-color: #e0f7fa;
      border-radius: 8px;
      padding: 10px;
      font-family: "Courier New", monospace;
      color: #004d40;
      direction: ltr;
      text-align: left;
      white-space: pre-wrap;
    }

    .note {
      background-color: #fff3cd;
      color: #856404;
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
    }

    .footer {
      margin-top: 30px;
      font-size: 14px;
      color: #555;
    }

    hr {
      border: 1px solid #ccc;
      margin: 30px 0;
    }
  </style>
</head>
<body>

  <h1>💻 الدرس الأول: مقدمة في البرمجة بلغة JavaScript</h1>

  <div class="content">
    <p>
      قبل ما نبدأ في الأكواد، تعال نفهم يعني إيه برمجة ببساطة.  
      تخيل إنك بتدي أوامر لصاحبك يعمل حاجات معينة زي: "هات كباية المية"،  
      "افتح النور"، "اقفل الباب"… البرمجة هي نفس الفكرة،  
      بس بدل ما بتكلم صاحبك، بتكلم **الكمبيوتر**!
    </p>

    <div class="note">
      🧠 الكمبيوتر مش بيفهم غير لغة الأوامر، وإحنا اللي بنعلمه إزاي يتصرف خطوة بخطوة.
    </div>

    <h3>🔹 أولًا: الطباعة في الكونسول</h3>
    <p>
      الكونسول ده زي المكان اللي الكمبيوتر بيكلمك فيه وبيطبعلك النتايج.  
      يعني لو قولتله "اطبعلي كلمة مرحبًا"، هتظهرلك هناك.
    </p>

    <pre class="code-editor" readonly>
console.log("مرحبًا بيك في عالم البرمجة!");
    </pre>

    <p>جرب بنفسك 👇</p>
    <textarea id="userCode1" class="code-editor" placeholder='اكتب هنا زي console.log("أنا بدأت أتعلم!");'></textarea><br>
    <button class="btn" onclick="runCode('userCode1', 'output1')">عرض النتيجة</button>
    <div id="output1" class="output"></div>

    <hr>

    <h3>🔹 ثانيًا: التعليقات في الكود</h3>
    <p>
      أوقات بتحتاج تكتب ملاحظات في الكود علشان تفتكرها بعدين.  
      التعليقات دي الكمبيوتر بيتجاهلها تمامًا، بس بتفيدك انت!  
      زي لما تكتب على ورقة "ما تنساش تعمل كذا".
    </p>

    <pre class="code-editor" readonly>
// ده تعليق مش بيتنفذ
console.log("أهلاً!");
    </pre>

    <p>جرب تعمل تعليق بنفسك 👇</p>
    <textarea id="userCode2" class="code-editor" placeholder='اكتب كود فيه تعليق'></textarea><br>
    <button class="btn" onclick="runCode('userCode2', 'output2')">عرض النتيجة</button>
    <div id="output2" class="output"></div>

    <hr>

    <h3>🔹 ثالثًا: أنواع البيانات</h3>
    <p>
      زي ما في حياتنا عندنا حاجات مختلفة (أسماء، أرقام، آراء)،  
      في البرمجة برضه في أنواع بيانات:  
      <strong>string</strong> يعني نص، <strong>number</strong> يعني رقم،  
      و<strong>boolean</strong> يعني صح أو غلط.
    </p>

    <pre class="code-editor" readonly>
let name = "أحمد";
let age = 20;
let isStudent = true;

console.log(name);
console.log(age);
console.log(isStudent);
    </pre>

    <p>جرب تكتب بياناتك 👇</p>
    <textarea id="userCode3" class="code-editor" placeholder='جرب تكتب كود فيه اسمك وسنك'></textarea><br>
    <button class="btn" onclick="runCode('userCode3', 'output3')">عرض النتيجة</button>
    <div id="output3" class="output"></div>

    <hr>

    <h3>🔹 رابعًا: العمليات الحسابية</h3>
    <p>
      الكمبيوتر بيقدر يحسب زي الآلة الحاسبة.  
      تقدر تجمع، تطرح، تضرب وتقسم بكل سهولة.
    </p>

    <pre class="code-editor" readonly>
let x = 10;
let y = 3;
console.log(x + y); // جمع
console.log(x - y); // طرح
console.log(x * y); // ضرب
console.log(x / y); // قسمة
    </pre>

    <p>جرب تحسب حاجة بنفسك 👇</p>
    <textarea id="userCode4" class="code-editor" placeholder='اكتب كود فيه عمليات حسابية'></textarea><br>
    <button class="btn" onclick="runCode('userCode4', 'output4')">عرض النتيجة</button>
    <div id="output4" class="output"></div>

    <hr>

    <h3>🧭 ملخص الدرس</h3>
    <ul>
      <li>البرمجة = أوامر للكمبيوتر.</li>
      <li>console.log() بتطبع الكلام أو النتايج.</li>
      <li>التعليقات بتساعدك تفتكر وتشرح الكود.</li>
      <li>في أنواع بيانات مختلفة (نصوص - أرقام - منطقية).</li>
      <li>تقدر تعمل عمليات حسابية زي الجمع والطرح والضرب.</li>
    </ul>

    <button class="btn" onclick="location.href='quiz1.html'">📘 اختبار الدرس</button>
    <button class="btn" onclick="location.href='index.html'">🏠 الرجوع للصفحة الرئيسية</button>
  </div>

  <div class="footer">
    تم التصميم بواسطة <strong>Ahmed Ezzat</strong> ❤️
  </div>

  <script>
  // ** دالة إزالة التعليقات **
  function removeComments(code) {
    return code
      .replace(/\/\*[\s\S]*?\*\//g, '')
      .replace(/\/\/.*$/gm, '');
  }

  // ** محلّل ذكي لتحديد الأخطاء بدقة **
  function analyzeCodeErrors(code) {
    const lines = code.split('\n');
    const stack = [];
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i].trim();
      if (line === '' || line.startsWith('//')) continue;

      // ✅ فحص الأقواس
      for (let ch of line) {
        if (ch === '(' || ch === '{' || ch === '[') stack.push(ch);
        else if (ch === ')' || ch === '}' || ch === ']') {
          const last = stack.pop();
          if (
            (ch === ')' && last !== '(') ||
            (ch === '}' && last !== '{') ||
            (ch === ']' && last !== '[')
          ) {
            return {
              valid: false,
              line: i + 1,
              message: '❌ الأقواس غير متطابقة أو مغلقة بشكل خاطئ.'
            };
          }
        }
      }

      // ✅ فحص الفاصلة المنقوطة
      if (
        !line.endsWith(';') &&
        !line.endsWith('{') &&
        !line.endsWith('}') &&
        !line.includes('function') &&
        !line.includes('if') &&
        !line.includes('for')
      ) {
        if (!line.startsWith('//') && line !== '') {
          return {
            valid: false,
            line: i + 1,
            message: '❌ ناقص فاصلة منقوطة (;) في نهاية السطر.'
          };
        }
      }

      // ✅ فحص علامات الاقتباس
      const quotes = (line.match(/["']/g) || []).length;
      if (quotes % 2 !== 0) {
        return {
          valid: false,
          line: i + 1,
          message: '❌ في علامة اقتباس مفقودة في السطر.'
        };
      }
    }

    if (stack.length > 0) {
      return {
        valid: false,
        line: lines.length,
        message: '❌ في أقواس مفتوحة غير مغلقة.'
      };
    }

    return { valid: true };
  }

  // ** التحقق من متطلبات التمرين **
  function validateCode(inputId, code) {
    const id = inputId.slice(-1);
    const cleaned = removeComments(code).trim();

    switch (id) {
      case '1':
        if (!/console\.log\(.+\)/.test(cleaned))
          return { valid: false, message: "❌ لازم تستخدم console.log() في الطباعة." };
        break;
      case '2':
        if (!/(\/\/|\/\*)/.test(code))
          return { valid: false, message: "❌ لازم تكتب تعليق في الكود باستخدام // أو /* */." };
        break;
      case '3':
        if (!/(let|const|var)\s+\w+\s*=/.test(cleaned))
          return { valid: false, message: "❌ لازم تعرف متغير زي let name = 'أحمد';" };
        break;
      case '4':
        if (!/(\+|\-|\*|\/)/.test(cleaned))
          return { valid: false, message: "❌ لازم تعمل عملية حسابية (+ - * /)." };
        break;
    }
    return { valid: true };
  }

  // ** تنفيذ الكود مع تحليل السطر الخطأ **
  function runCode(inputId, outputId) {
    const textarea = document.getElementById(inputId);
    const code = textarea.value;
    const output = document.getElementById(outputId);

    output.textContent = '';
    output.style.color = '#004d40';
    textarea.classList.remove('highlight-error');

    // 1️⃣ تحليل الأخطاء قبل التنفيذ
    const analysis = analyzeCodeErrors(code);
    if (!analysis.valid) {
      output.style.color = '#dc3545';
      output.textContent = `${analysis.message}\n📍 السطر رقم: ${analysis.line}`;
      highlightErrorLine(textarea, analysis.line);
      return;
    }

    // 2️⃣ التحقق من متطلبات الدرس
    const validation = validateCode(inputId, code);
    if (!validation.valid) {
      output.style.color = '#dc3545';
      output.textContent = validation.message;
      return;
    }

    // 3️⃣ تنفيذ الكود
    try {
      let result = '';
      const originalLog = console.log;
      console.log = (...args) => (result += args.join(' ') + '\n');
      eval(code);
      console.log = originalLog;

      output.style.color = '#00796b';
      output.textContent = result.trim()
        ? "✅ صح! ناتج الكود:\n" + result.trim()
        : "✅ صح! الكود سليم واشتغل بنجاح.";
    } catch (err) {
      output.style.color = '#dc3545';
      output.textContent = "❌ غلط في التنفيذ: " + err.message;
    }
  }

  // ** تظليل السطر الخطأ بدون تعديل النص **
  function highlightErrorLine(textarea, lineNumber) {
    const lines = textarea.value.split('\n');
    const before = lines.slice(0, lineNumber - 1).join('\n').length;
    const start = before + (lineNumber > 1 ? 1 : 0);
    const end = start + lines[lineNumber - 1].length;

    textarea.focus();
    textarea.setSelectionRange(start, end);
    textarea.classList.add('highlight-error');
  }
</script>

<style>
  .highlight-error {
    background: rgba(255, 0, 0, 0.08);
    transition: background 0.3s;
  }
</style>


</body>
</html>



