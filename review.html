<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>المراجعة - دروس JavaScript (1-3)</title>
  <style>
    /* تم التأكد من استخدام مسافات عادية وترميز UTF-8 (بدون BOM) */
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');

    :root{
      --primary: #00796b;
      --green1: #009688;
      --green2: #26a69a;
      --bg1: #f9f9f9;
      --bg2: #e0f7fa;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Cairo', sans-serif;
      /* خلفية احتياطية + تدريجية */
      background-color: var(--bg1);
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      margin: 0;
      padding: 20px;
      color: #222;
    }

    header.container {
      text-align: center;
      margin-bottom: 14px;
    }

    h1 {
      color: var(--primary);
      margin: 0 0 6px 0;
      font-size: 1.9rem;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    .card {
      background: #fff;
      border-radius: 14px;
      padding: 20px;
      margin: 18px 0;
      box-shadow: 0 8px 30px rgba(0,0,0,0.06);
      text-align: right;
    }

    h2 {
      color: #00695c;
      margin-top: 0;
    }

    .lead {
      font-weight: 700;
      color: #333;
      line-height: 1.7;
    }

    pre.reference {
      background: #f1f8e9;
      border: 2px solid var(--green1);
      padding: 12px;
      border-radius: 10px;
      font-family: monospace;
      direction: ltr;
      text-align: left;
      overflow-x: auto;
    }

    textarea.editor {
      width: 100%;
      min-height: 110px;
      font-family: monospace;
      font-size: 14px;
      direction: ltr;
      text-align: left;
      border-radius: 8px;
      padding: 10px;
      border: 2px solid #d6eae6;
      background: #fff;
      resize: vertical;
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    /* أنماط الأزرار وتأثير التحريك (Hover) */
    .btn, .btn.ghost {
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      padding: 10px 18px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 800;
      border: 2px solid transparent;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    .btn {
      background: linear-gradient(90deg, var(--green1), var(--green2));
      color: #fff;
      border: none;
    }

    .btn.ghost {
      background: #fff;
      color: var(--green1);
      border-color: var(--green2);
    }

    .btn:hover, .btn.ghost:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .output {
      margin-top: 10px;
      background: #e0f7fa;
      padding: 10px;
      border-radius: 8px;
      font-family: monospace;
      direction: ltr;
      text-align: left;
      white-space: pre-wrap;
      min-height: 48px;
    }

    .solution {
      margin-top: 8px;
      background: #fff6e6;
      padding: 10px;
      border-radius: 8px;
      font-family: monospace;
      direction: ltr;
      text-align: left;
      white-space: pre-wrap;
      display: none;
    }

    .questions {
      margin-top: 12px;
    }

    .question {
      background: #f7fff7;
      border: 1px solid #d1f5d1;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .project {
      background: #e8f5e9;
      border: 1px solid #c8e6c9;
      padding: 20px;
      border-radius: 10px;
    }

    .navs {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    footer {
      text-align: center;
      margin-top: 18px;
      color: #555;
    }

    .small {
      font-size: 13px;
    }

    @media (max-width: 720px) {
      .controls { flex-direction: column; }
    }

    .highlight-error {
      background: rgba(255,0,0,0.06);
      outline: 2px solid rgba(255,0,0,0.12);
    }

    .mc-options {
      display: flex;
      gap: 8px;
      flex-direction: column;
    }

    .check-btn {
      background: #004d40;
      color: #fff;
      padding: 6px 10px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      margin-top: 8px;
    }

    .correct { color: #0a7b3a; font-weight: 800; }
    .wrong { color: #b00020; font-weight: 800; }

    /* أنماط خاصة بالتقييم والمحرر */
    .terminal {
      background: #272822;
      color: #f8f8f2;
      padding: 15px;
      border-radius: 8px;
      margin-top: 5px;
      min-height: 40px;
      white-space: pre-wrap;
      font-family: monospace;
    }

    .status-box {
      padding: 10px;
      border-radius: 8px;
      font-weight: bold;
      margin-top: 15px;
      text-align: center;
      transition: background-color 0.4s;
    }

    .status-correct { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .status-wrong { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }

  </style>
</head>
<body>
  <header class="container">
    <h1>📚 مراجعة شاملة - الدروس 1 إلى 3 في JavaScript</h1>
    <p class="lead">شرح مفصّل، أسئلة قصيرة تفاعلية، وتجربة عملية لكل درس + مشروع بسيط.</p>
  </header>

  <main class="container">

    <!-- الدرس الأول -->
    <section class="card" id="lesson1">
      <h2>🔹 الدرس الأول: الطباعة والتعليقات (Console & Comments)</h2>
      <p>الشرح التفصيلي:</p>
      <div class="lead">console.log() تستخدم لعرض النواتج في Console أثناء تعلمك. التعليقات تكتب ملاحظات داخل الكود: <code>//</code> للسطر الواحد و<code>/* ... */</code> للتعليقات متعددة الأسطر.</div>

      <h3>أمثلة مرجعية</h3>
      <pre class="reference">// تعليق للسطر
console.log("مرحبًا بالعالم!");
/* تعليق
متعدد
الأسطر */</pre>

      <label>اكتب كود بسيط يحتوي على تعليق وطباعة:</label>
      <textarea id="code1" class="editor">// تعليق: رسالة ترحيب
console.log("أنا بدأت أتعلم JavaScript");</textarea>
      <div class="controls">
        <button class="btn" onclick="runReview('code1','out1','sol1',1)">▶ تشغيل</button>
        <button class="btn ghost" onclick="toggleSolution('sol1')">👀 عرض الحل</button>
      </div>
      <div id="out1" class="output"></div>
      <pre id="sol1" class="solution">// مثال للحل
// تعليق: رسالة ترحيب
console.log("مرحبًا بيك في عالم البرمجة!");</pre>

      <h3>أسئلة قصيرة (اختر الإجابة الصحيحة)</h3>
      <div class="questions">
        <div class="question">
          1) ما دور <code>//</code>؟
          <div class="mc-options">
            <label><input type="radio" name="l1q1" value="a"> أ) يعلق سطر واحد فقط</label>
            <label><input type="radio" name="l1q1" value="b"> ب) يعلق عدة أسطر</label>
            <label><input type="radio" name="l1q1" value="c"> ج) ينفّذ ككود</label>
          </div>
          <button class="check-btn" onclick="checkMC('l1q1','out1q1','a')">تحقق</button>
          <div id="out1q1"></div>
        </div>

        <div class="question">
          2) أيّهما مناسب لطباعة ناتج بسيط أثناء التعلم؟
          <div class="mc-options">
            <label><input type="radio" name="l1q2" value="a"> أ) alert()</label>
            <label><input type="radio" name="l1q2" value="b"> ب) console.log()</label>
            <label><input type="radio" name="l1q2" value="c"> ج) prompt()</label>
          </div>
          <button class="check-btn" onclick="checkMC('l1q2','out1q2','b')">تحقق</button>
          <div id="out1q2"></div>
        </div>

        <div class="question">
          3) أيّ تعبير ينشئ تعليق متعدد الأسطر؟
          <div class="mc-options">
            <label><input type="radio" name="l1q3" value="a"> أ) // comment</label>
            <label><input type="radio" name="l1q3" value="b"> ب) &lt;!-- comment --&gt;</label>
            <label><input type="radio" name="l1q3" value="c"> ج) /* comment */</label>
          </div>
          <button class="check-btn" onclick="checkMC('l1q3','out1q3','c')">تحقق</button>
          <div id="out1q3"></div>
        </div>
      </div>
    </section>

    <!-- الدرس الثاني -->
    <section class="card" id="lesson2">
      <h2>🔹 الدرس الثاني: المتغيرات والجمل الشرطية</h2>
      <p>الشرح التفصيلي:</p>
      <div class="lead">المتغيرات (let, const, var) تخزن البيانات. if/else يتحكم في تنفيذ أجزاء الكود حسب شروط معينة. استخدم === للمقارنة الآمنة لأنّه يتحقق من النوع والقيمة.</div>

      <h3>أمثلة مرجعية</h3>
      <pre class="reference">let math = 45;
if (math <= 50) {
  console.log("Add homework");
} else {
  console.log("Good job!");
}</pre>

      <label>اكتب كود يتحقق من قيمة math ويطبع حسب الشرح:</label>
      <textarea id="code2" class="editor">let math = 49;
if (math <= 50) {
  console.log("Add homework");
} else {
  console.log("Good job!");
}</textarea>
      <div class="controls">
        <button class="btn" onclick="runReview('code2','out2','sol2',2)">▶ تشغيل</button>
        <button class="btn ghost" onclick="toggleSolution('sol2')">👀 عرض الحل</button>
      </div>
      <div id="out2" class="output"></div>
      <pre id="sol2" class="solution">// حل مرجعي
let math = 49;
if (math <= 50) {
  console.log("Add homework");
} else {
  console.log("Good job!");
}</pre>

      <h3>أسئلة قصيرة (اختر الإجابة الصحيحة)</h3>
      <div class="questions">
        <div class="question">
          1) متى نستخدم <code>const</code>؟
          <div class="mc-options">
            <label><input type="radio" name="l2q1" value="a"> أ) عندما تكون القيمة ثابتة ولا تتغير</label>
            <label><input type="radio" name="l2q1" value="b"> ب) عندما نريد إعادة الإسناد كثيرًا</label>
            <label><input type="radio" name="l2q1" value="c"> ج) لتصريح عن دالة</label>
          </div>
          <button class="check-btn" onclick="checkMC('l2q1','out2q1','a')">تحقق</button>
          <div id="out2q1"></div>
        </div>

        <div class="question">
          2) ما الفرق بين <code>==</code> و <code>===</code>؟
          <div class="mc-options">
            <label><input type="radio" name="l2q2" value="a"> أ) لا فرق</label>
            <label><input type="radio" name="l2q2" value="b"> ب) === يتحقق من القيمة والنوع، == يقارن القيم فقط</label>
            <label><input type="radio" name="l2q2" value="c"> ج) == يتحقق من النوع فقط</label>
          </div>
          <button class="check-btn" onclick="checkMC('l2q2','out2q2','b')">تحقق</button>
          <div id="out2q2"></div>
        </div>

        <div class="question">
          3) اكتب التعبير الذي يضيف 10 إلى المتغير score (اختر):
          <div class="mc-options">
            <label><input type="radio" name="l2q3" value="a"> أ) score = score + 10;</label>
            <label><input type="radio" name="l2q3" value="b"> ب) score += 10;</label>
            <label><input type="radio" name="l2q3" value="c"> ج) كلاهما صحيح</label>
          </div>
          <button class="check-btn" onclick="checkMC('l2q3','out2q3','c')">تحقق</button>
          <div id="out2q3"></div>
        </div>
      </div>
    </section>

    <!-- الدرس الثالث -->
    <section class="card" id="lesson3">
      <h2>🔹 الدرس الثالث: المقارنات المتقدمة، else if، && و ||</h2>
      <p>الشرح التفصيلي:</p>
      <div class="lead">استخدم المقارنات (&lt;, &gt;, &lt;=, &gt;=) لتحديد مدى. else if يسمح بشرطّات مترتبة. && يتطلب صحة كل الشروط، || يكفي شرط واحد. ضع أقواسًا لتحديد ترتيب التقييم عند الدمج.</div>

      <h3>أمثلة مرجعية</h3>
      <pre class="reference">let years = 8;
let rating = 3;
let projects = 20;
if (years > 5 && (rating > 4 || projects > 15)) {
  console.log("Promotion Approved");
} else {
  console.log("Promotion Denied");
}</pre>

      <label>جرب المثال وعدّل القيم لترى النتائج:</label>
      <textarea id="code3" class="editor">let years = 8;
let rating = 3;
let projects = 20;
if (years > 5 && (rating > 4 || projects > 15)) {
  console.log("Promotion Approved");
} else {
  console.log("Promotion Denied");
}</textarea>
      <div class="controls">
        <button class="btn" onclick="runReview('code3','out3','sol3',3)">▶ تشغيل</button>
        <button class="btn ghost" onclick="toggleSolution('sol3')">👀 عرض الحل</button>
      </div>
      <div id="out3" class="output"></div>
      <pre id="sol3" class="solution">// حل مرجعي
let years = 8;
let rating = 3;
let projects = 20;
if (years > 5 && (rating > 4 || projects > 15)) {
  console.log("Promotion Approved");
} else {
  console.log("Promotion Denied");
}</pre>

      <h3>أسئلة قصيرة (اختر الإجابة الصحيحة)</h3>
      <div class="questions">
        <div class="question">
          1) ماذا يعني <code>&&</code>؟
          <div class="mc-options">
            <label><input type="radio" name="l3q1" value="a"> أ) أو (OR)</label>
            <label><input type="radio" name="l3q1" value="b"> ب) و (AND)</label>
            <label><input type="radio" name="l3q1" value="c"> ج) ليس (NOT)</label>
          </div>
          <button class="check-btn" onclick="checkMC('l3q1','out3q1','b')">تحقق</button>
          <div id="out3q1"></div>
        </div>

        <div class="question">
          2) لماذا نستخدم أقواس عند دمج && و ||؟
          <div class="mc-options">
            <label><input type="radio" name="l3q2" value="a"> أ) لتنظيم الكود فقط</label>
            <label><input type="radio" name="l3q2" value="b"> ب) لتحديد ترتيب التقييم وضمان النتيجة الصحيحة</label>
            <label><input type="radio" name="l3q2" value="c"> ج) لتسريع التنفيذ</label>
          </div>
          <button class="check-btn" onclick="checkMC('l3q2','out3q2','b')">تحقق</button>
          <div id="out3q2"></div>
        </div>

        <div class="question">
          3) أي خيار ينفذ "B" عندما x = 7؟
          <div class="mc-options">
            <label><input type="radio" name="l3q3" value="a"> أ) if(x>10) console.log('A'); else if(x>5) console.log('B'); else console.log('C');</label>
            <label><input type="radio" name="l3q3" value="b"> ب) if(x>5) console.log('A'); else console.log('B');</label>
            <label><input type="radio" name="l3q3" value="c"> ج) if(x>10) console.log('A'); else console.log('C');</label>
          </div>
          <button class="check-btn" onclick="checkMC('l3q3','out3q3','a')">تحقق</button>
          <div id="out3q3"></div>
        </div>
      </div>
    </section>

    <!-- مشروع تقييم الدرجات التفاعلي -->
    <section class="card project" id="simple-project">
      <h2>🏆 مشروع تفاعلي (الدروس 1-3): تقييم الدرجات</h2>
      <p class="lead">المطلوب منك هو بناء نظام بسيط لتقييم درجات الطلاب. استخدم المفاهيم التي تعلمتها (المتغيرات، if/else if، المقارنات). يجب أن يقبل الكود الخاص بك مُتغيراً باسم <code>score</code>.
        <br><br>
        <strong>القواعد:</strong>
        <ol>
          <li>إذا كانت <code>score</code> أكبر من أو تساوي 90: اطبع في الكونسول <code>"Excellent"</code>.</li>
          <li>وإلا إذا كانت <code>score</code> أكبر من أو تساوي 70: اطبع <code>"Good"</code>.</li>
          <li>في جميع الأحوال الأخرى: اطبع <code>"Needs Improvement"</code>.</li>
        </ol>
      </p>

      <label>📝 محرر الأكواد (اكتب الكود الخاص بك هنا):</label>
      <textarea id="project-code" class="editor" style="min-height:200px;">// لا تنسى تعريف المتغير score
// مثال: let score = 85; 

// ابدأ كتابة جمل if/else if هنا
</textarea>
      <div class="controls">
        <button class="btn" onclick="checkProject()">✅ تحقق من الحل</button>
      </div>

      <label>💻 نافذة الناتج (الكونسول):</label>
      <pre id="project-output" class="terminal"></pre>
      <label>📊 نتيجة التحقق من الحل:</label>
      <div id="project-status" class="status-box"></div>
    </section>

    <!-- شريط التنقل النهائي (تم تعديله كما طلبت) -->
    <div class="navs">
      <button class="btn" onclick="location.href='lesson3.html'">⬅️ الرجوع للدرس الثالث</button>
      <button class="btn" onclick="location.href='lesson4.html'">الدرس الرابع ⬅️</button>
    </div>

    <footer>
      <div class="footer small">تم التصميم بواسطة <strong>Ahmed Ezzat</strong> ❤️</div>
    </footer>

  </main>

<script>
/* تنفيذ الكود مع التقاط console.log وإرجاع النتيجة */
function executeAndCapture(codeStr, globalVars = {}){
  const logs = [];
  const origConsole = console.log;
  console.log = function(...args){ logs.push(args.map(a=>{
    try{ return typeof a === 'object' ? JSON.stringify(a) : String(a); }
    catch(e){ return String(a); }
  }).join(' ')); };
  let err = null;
  try{
    const keys = Object.keys(globalVars);
    const values = Object.values(globalVars);
    const fn = new Function(...keys, codeStr);
    fn(...values);
  }catch(e){ err = e; }
  console.log = origConsole;
  return { logs, error: err };
}

/* تشغيل ومراجعة ذكية لكل تمرين (للقياسات في الدروس 1-3) */
function runReview(textareaId,outId,solId,lesson){
  try{
    const code = document.getElementById(textareaId).value || '';
    const out = document.getElementById(outId);
    const sol = document.getElementById(solId);
    out.style.color = '#004d40'; out.textContent = '';
    if(!code.trim()){ out.textContent = '⚠️ اكتب كود قبل التشغيل.'; return; }

    const res = executeAndCapture(code);
    if(res.error){ out.style.color='#a00'; out.textContent = '❌ خطأ أثناء التنفيذ: '+res.error.message; return; }
    const outputText = res.logs.join('\n');

    let feedback = '';
    if(lesson === 1){
      const hasConsole = /console\.log\s*\(/.test(code);
      const hasComment = /(\/\/|\/\*)/.test(code);
      if(hasConsole && hasComment) feedback = '✅ ممتاز! استخدمت console.log وتعليق.';
      else if(!hasConsole) feedback = '❌ لازم تستخدم console.log لعرض النتيجة.';
      else feedback = '❌ ضع تعليقًا واحدًا على الأقل في الكود.';
    }
    if(lesson === 2){
      const hasIf = /if\s*\(.*math.*(<=|<|>=|>)?.*\)/.test(code);
      const hasElse = /else\b/.test(code);
      if(hasIf && hasElse) feedback = '✅ صح! استخدمت if/else على متغير math.';
      else feedback = '❌ تأكد من كتابة if تحتوي math وتضمّن else.';
    }
    if(lesson === 3){
      const hasElseIf = /else\s*if/.test(code);
      const hasLogic = /(\&\&|\|\|)/.test(code);
      if(hasElseIf || hasLogic) feedback = '✅ تمام! استخدمت else if أو المعاملات المنطقية.';
      else feedback = '❌ حاول استخدام else if أو && / || في شرط.';
    }

    out.textContent = feedback + (outputText ? '\n\n📤 ناتج الكود:\n' + outputText : '');
  }catch(e){ const out=document.getElementById(outId); out.style.color='#a00'; out.textContent='❌ خطأ: '+e.message; }
}

/* وظيفة التحقق من المشروع التفاعلي الجديد */
function checkProject(){
    const code = document.getElementById('project-code').value || '';
    const outputEl = document.getElementById('project-output');
    const statusEl = document.getElementById('project-status');
    outputEl.textContent = '';
    statusEl.textContent = '';
    statusEl.className = 'status-box';

    if(!code.trim()){
        statusEl.textContent = '⚠️ الرجاء كتابة الكود الخاص بك أولاً.';
        statusEl.classList.add('status-wrong');
        return;
    }

    // 1. تحديد حالات الاختبار (Test Cases)
    const testCases = [
        { score: 95, expected: "Excellent" },         // >= 90
        { score: 80, expected: "Good" },              // >= 70 AND < 90
        { score: 65, expected: "Needs Improvement" }  // < 70
    ];
    
    let allPassed = true;
    let combinedOutput = "--- بدء الاختبارات ---\n";

    // 2. تكرار واختبار كل حالة
    for(const test of testCases){
        // يجب أن يسبق الكود جملة تعريف المتغير score
        const fullCode = `let score = ${test.score};\n${code}`;
        const res = executeAndCapture(fullCode);
        
        combinedOutput += `\n[الدرجة المختبرة: ${test.score}]\n`;

        if(res.error){
            allPassed = false;
            combinedOutput += `❌ خطأ في التنفيذ: ${res.error.message}\n`;
            break; // توقف عند أول خطأ برمجي
        }

        // بما أن الناتج قد يحتوي على أسطر متعددة، نأخذ أول سطر فقط للتقييم
        const actualOutput = res.logs.length > 0 ? res.logs[0].trim() : "";
        
        combinedOutput += `الناتج الفعلي: "${actualOutput}"\n`;

        if(actualOutput === test.expected){
            combinedOutput += `✅ النتيجة صحيحة.\n`;
        } else {
            combinedOutput += `❌ النتيجة خاطئة. المتوقع: "${test.expected}"\n`;
            allPassed = false;
        }
    }
    
    combinedOutput += "\n--- نهاية الاختبارات ---\n";
    outputEl.textContent = combinedOutput;

    // 3. عرض حالة المشروع النهائية
    if(allPassed){
        statusEl.textContent = '✅ مبروك! الحل صحيح ويعمل لجميع حالات الاختبار!';
        statusEl.classList.add('status-correct');
    } else {
        statusEl.textContent = '❌ الحل خاطئ. راجع النواتج في نافذة الكونسول وحاول مرة أخرى.';
        statusEl.classList.add('status-wrong');
    }
}

/* عرض الحل (toggle) */
function toggleSolution(id){ const el = document.getElementById(id); if(!el) return; el.style.display = el.style.display === 'block' ? 'none' : 'block'; }

/* التحقق من الأسئلة الاختيارية (multiple choice) */
function checkMC(name,outId,correct){
  const radios = document.getElementsByName(name);
  let selected = null;
  for(const r of radios) if(r.checked) selected = r.value;
  const out = document.getElementById(outId);
  if(!selected){ out.innerHTML = '<span class="wrong">❌ اختر إجابة أولاً.</span>'; return; }
  if(selected === correct) out.innerHTML = '<span class="correct">✅ إجابة صحيحة</span>'; else out.innerHTML = '<span class="wrong">❌ إجابة خاطئة</span>';
}
</script>
</body>
</html>
